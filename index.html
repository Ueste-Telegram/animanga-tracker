<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AniManga Tracker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø TELEGRAM MINI APP */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 100%;
            padding: 10px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-top: 10px;
        }
        
        .header h1 {
            margin: 0 0 5px 0;
            font-size: 24px;
            font-weight: 700;
        }
        
        .header p {
            margin: 0;
            color: #b0b0b0;
            font-size: 14px;
        }
        
        /* –¢–ê–ë–´ - –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–´ –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• */
        .tabs {
            display: flex;
            overflow-x: auto;
            gap: 5px;
            margin-bottom: 20px;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        
        .tabs::-webkit-scrollbar {
            display: none;
        }
        
        .tab {
            flex: 1;
            min-width: 70px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 12px 8px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 12px;
            text-align: center;
            transition: all 0.2s ease;
            white-space: nowrap;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        /* –°–ï–ö–¶–ò–ò –ö–û–ù–¢–ï–ù–¢–ê */
        .content {
            position: relative;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –§–û–†–ú–´ - –£–í–ï–õ–ò–ß–ï–ù–´ –î–õ–Ø –ö–ê–°–ê–ù–ò–Ø */
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #cccccc;
            font-size: 14px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 16px; /* –£–≤–µ–ª–∏—á–∏–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–≤–æ–¥–∞ */
            transition: all 0.2s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 14px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.2s ease;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* –ö–ê–†–¢–û–ß–ö–ò –≠–õ–ï–ú–ï–ù–¢–û–í */
        .item-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }
        
        .item-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .item-title {
            font-weight: 600;
            font-size: 16px;
            margin: 0;
            color: white;
        }
        
        .item-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .item-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
            font-size: 12px;
            color: #b0b0b0;
        }
        
        .item-progress {
            margin-bottom: 12px;
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            font-size: 11px;
            color: #b0b0b0;
            display: flex;
            justify-content: space-between;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        
        .action-btn:hover {
            background: rgba(102, 126, 234, 0.3);
        }
        
        /* –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô */
        .notifications-panel {
            position: fixed;
            top: 20px;
            right: 10px;
            z-index: 1000;
            max-width: 300px;
        }
        
        .notification {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            border-left: 4px solid #FFD700;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .notification-message {
            font-size: 12px;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        /* –°–ï–ö–¶–ò–Ø –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ô */
        .reminders-section {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .reminder-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .reminder-actions {
            display: flex;
            gap: 8px;
        }
        
        .reminder-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        /* –¶–ï–õ–ò */
        .goal-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .goal-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .goal-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        /* –ù–ê–°–¢–†–û–ô–ö–ò */
        .settings-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* –°–¢–ê–¢–£–°–´ */
        .status-tabs {
            display: flex;
            overflow-x: auto;
            gap: 5px;
            margin-bottom: 15px;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
        }
        
        .status-tab {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 12px;
            text-align: center;
            transition: all 0.2s ease;
            white-space: nowrap;
        }
        
        .status-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }
        
        /* –†–ï–ô–¢–ò–ù–ì */
        .rating {
            display: flex;
            gap: 2px;
            margin: 10px 0;
        }
        
        .star {
            font-size: 20px;
            color: #555;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        
        .star.active {
            color: #FFD700;
        }
        
        /* –¢–ï–ì–ò */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }
        
        .tag {
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• */
        @media (max-width: 480px) {
            .container {
                padding: 8px;
            }
            
            .tab {
                padding: 10px 6px;
                font-size: 11px;
            }
            
            .form-control {
                padding: 12px;
            }
            
            .btn {
                padding: 12px 16px;
                font-size: 14px;
            }
        }
        
        /* –£–õ–£–ß–®–ï–ù–ò–Ø –î–õ–Ø TELEGRAM WEB APP */
        .tg-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            z-index: -1;
        }
    </style>
</head>
<body>
    <div class="tg-background"></div>
    <div class="container">
        <!-- –ü–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
        <div class="notifications-panel" id="notificationsPanel"></div>
        
        <div class="header">
            <h1>üéå AniManga Tracker</h1>
            <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Å–≤–æ–∏ –∞–Ω–∏–º–µ –∏ –º–∞–Ω–≥—É</p>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showSection('anime')">üé¨ –ê–Ω–∏–º–µ</button>
            <button class="tab" onclick="showSection('manga')">üìö –ú–∞–Ω–≥–∞</button>
            <button class="tab" onclick="showSection('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button class="tab" onclick="showSection('reminders')">üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</button>
            <button class="tab" onclick="showSection('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>
        
        <div class="content">
            <!-- –°–ï–ö–¶–ò–Ø –ê–ù–ò–ú–ï -->
            <div id="anime" class="section active">
                <div class="form-group">
                    <label for="animeTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∞–Ω–∏–º–µ</label>
                    <input type="text" id="animeTitle" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                </div>
                
                <div class="form-group">
                    <label for="animeStatus">–°—Ç–∞—Ç—É—Å</label>
                    <select id="animeStatus" class="form-control">
                        <option value="watching">–°–º–æ—Ç—Ä—é</option>
                        <option value="planned">–í –ø–ª–∞–Ω–∞—Ö</option>
                        <option value="completed">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</option>
                        <option value="dropped">–ë—Ä–æ—à–µ–Ω–æ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="animeEpisodes">–í—Å–µ–≥–æ —ç–ø–∏–∑–æ–¥–æ–≤</label>
                    <input type="number" id="animeEpisodes" class="form-control" value="12" min="1">
                </div>
                
                <div class="form-group">
                    <label for="animeProgress">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ —ç–ø–∏–∑–æ–¥–æ–≤</label>
                    <input type="number" id="animeProgress" class="form-control" value="0" min="0">
                </div>
                
                <div class="form-group">
                    <label>–†–µ–π—Ç–∏–Ω–≥</label>
                    <div class="rating" id="animeRating">
                        <span class="star" data-value="1">‚òÖ</span>
                        <span class="star" data-value="2">‚òÖ</span>
                        <span class="star" data-value="3">‚òÖ</span>
                        <span class="star" data-value="4">‚òÖ</span>
                        <span class="star" data-value="5">‚òÖ</span>
                    </div>
                </div>
                
                <button class="btn" onclick="addAnime()">–î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–µ</button>
                
                <div class="status-tabs" id="animeStatusTabs">
                    <button class="status-tab active" data-status="all">–í—Å–µ</button>
                    <button class="status-tab" data-status="watching">–°–º–æ—Ç—Ä—é</button>
                    <button class="status-tab" data-status="planned">–í –ø–ª–∞–Ω–∞—Ö</button>
                    <button class="status-tab" data-status="completed">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</button>
                    <button class="status-tab" data-status="dropped">–ë—Ä–æ—à–µ–Ω–æ</button>
                </div>
                
                <div id="animeList">
                    <!-- –°–ø–∏—Å–æ–∫ –∞–Ω–∏–º–µ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –°–ï–ö–¶–ò–Ø –ú–ê–ù–ì–ò -->
            <div id="manga" class="section">
                <div class="form-group">
                    <label for="mangaTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–Ω–≥–∏</label>
                    <input type="text" id="mangaTitle" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                </div>
                
                <div class="form-group">
                    <label for="mangaStatus">–°—Ç–∞—Ç—É—Å</label>
                    <select id="mangaStatus" class="form-control">
                        <option value="reading">–ß–∏—Ç–∞—é</option>
                        <option value="planned">–í –ø–ª–∞–Ω–∞—Ö</option>
                        <option value="completed">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</option>
                        <option value="dropped">–ë—Ä–æ—à–µ–Ω–æ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="mangaChapters">–í—Å–µ–≥–æ –≥–ª–∞–≤</label>
                    <input type="number" id="mangaChapters" class="form-control" value="50" min="1">
                </div>
                
                <div class="form-group">
                    <label for="mangaProgress">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ –≥–ª–∞–≤</label>
                    <input type="number" id="mangaProgress" class="form-control" value="0" min="0">
                </div>
                
                <div class="form-group">
                    <label>–†–µ–π—Ç–∏–Ω–≥</label>
                    <div class="rating" id="mangaRating">
                        <span class="star" data-value="1">‚òÖ</span>
                        <span class="star" data-value="2">‚òÖ</span>
                        <span class="star" data-value="3">‚òÖ</span>
                        <span class="star" data-value="4">‚òÖ</span>
                        <span class="star" data-value="5">‚òÖ</span>
                    </div>
                </div>
                
                <button class="btn" onclick="addManga()">–î–æ–±–∞–≤–∏—Ç—å –º–∞–Ω–≥—É</button>
                
                <div class="status-tabs" id="mangaStatusTabs">
                    <button class="status-tab active" data-status="all">–í—Å–µ</button>
                    <button class="status-tab" data-status="reading">–ß–∏—Ç–∞—é</button>
                    <button class="status-tab" data-status="planned">–í –ø–ª–∞–Ω–∞—Ö</button>
                    <button class="status-tab" data-status="completed">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</button>
                    <button class="status-tab" data-status="dropped">–ë—Ä–æ—à–µ–Ω–æ</button>
                </div>
                
                <div id="mangaList">
                    <!-- –°–ø–∏—Å–æ–∫ –º–∞–Ω–≥–∏ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –°–ï–ö–¶–ò–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ò -->
            <div id="stats" class="section">
                <div class="reminders-section">
                    <h3>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div id="generalStats">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</div>
                    </div>
                </div>
                
                <div class="reminders-section">
                    <h3>üìà –ì—Ä–∞—Ñ–∏–∫–∏</h3>
                    <canvas id="statsChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <!-- –°–ï–ö–¶–ò–Ø –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ô -->
            <div id="reminders" class="section">
                <div class="reminders-section">
                    <h3>üîî –ê–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h3>
                    <div id="activeReminders">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π...</div>
                    </div>
                </div>
                
                <div class="goals-section">
                    <h3>üéØ –ú–æ–∏ —Ü–µ–ª–∏</h3>
                    <div id="goalsList">
                        <!-- –¶–µ–ª–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <!-- –°–ï–ö–¶–ò–Ø –ù–ê–°–¢–†–û–ï–ö -->
            <div id="settings" class="section">
                <div class="reminders-section">
                    <h3>üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                    
                    <div class="settings-option">
                        <div>
                            <div class="settings-label">–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                            <div class="settings-description">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="notificationsEnabled" checked onchange="toggleNotifications()">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="settings-option">
                        <div>
                            <div class="settings-label">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ</div>
                            <div class="settings-description">–ù–∞–ø–æ–º–∏–Ω–∞—Ç—å –æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞/—á—Ç–µ–Ω–∏—è</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="progressReminders" checked onchange="saveNotificationSettings()">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="reminders-section">
                    <h3>üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
                    <button class="btn" onclick="exportData()">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="btn btn-secondary" onclick="importData()">–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="btn btn-secondary" onclick="clearData()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // üîß –û–°–ù–û–í–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let tg = null;
        let currentAnimeRating = 0;
        let currentMangaRating = 0;
        
        // üîß –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELEGRAM WEB APP
        function initTelegramApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                tg = window.Telegram.WebApp;
                tg.expand();
                tg.enableClosingConfirmation();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É Telegram
                if (tg.colorScheme === 'dark') {
                    document.body.style.background = 'linear-gradient(135deg, #1a1a2e, #16213e)';
                } else {
                    document.body.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
                }
                
                console.log('Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                console.log('Telegram Web App –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
            }
        }
        
        // üîß –°–ò–°–¢–ï–ú–ê –•–†–ê–ù–ï–ù–ò–Ø –î–ê–ù–ù–´–•
        function getUserId() {
            if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
                return tg.initDataUnsafe.user.id.toString();
            }
            return 'default_user';
        }
        
        function loadData() {
            const userId = getUserId();
            const key = `animanga_data_${userId}`;
            try {
                const data = localStorage.getItem(key);
                if (data) {
                    return JSON.parse(data);
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', e);
            }
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            return {
                anime: [],
                manga: [],
                settings: {},
                notificationSettings: {
                    enabled: true,
                    progressReminders: true,
                    goalNotifications: true,
                    frequency: 3
                }
            };
        }
        
        function saveData(data) {
            const userId = getUserId();
            const key = `animanga_data_${userId}`;
            try {
                localStorage.setItem(key, JSON.stringify(data));
                return true;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', e);
                return false;
            }
        }
        
        // üîß –°–ò–°–¢–ï–ú–ê –†–ï–ô–¢–ò–ù–ì–ê
        function initializeRatingSystem() {
            // –ê–Ω–∏–º–µ —Ä–µ–π—Ç–∏–Ω–≥
            const animeStars = document.querySelectorAll('#animeRating .star');
            animeStars.forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    currentAnimeRating = value;
                    
                    animeStars.forEach((s, index) => {
                        if (index < value) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });
            
            // –ú–∞–Ω–≥–∞ —Ä–µ–π—Ç–∏–Ω–≥
            const mangaStars = document.querySelectorAll('#mangaRating .star');
            mangaStars.forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    currentMangaRating = value;
                    
                    mangaStars.forEach((s, index) => {
                        if (index < value) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });
        }
        
        // üîß –°–ò–°–¢–ï–ú–ê –°–¢–ê–¢–£–°–û–í
        function initializeStatusTabs() {
            // –ê–Ω–∏–º–µ —Å—Ç–∞—Ç—É—Å—ã
            const animeTabs = document.querySelectorAll('#animeStatusTabs .status-tab');
            animeTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    animeTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    const status = this.getAttribute('data-status');
                    filterAnimeByStatus(status);
                });
            });
            
            // –ú–∞–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å—ã
            const mangaTabs = document.querySelectorAll('#mangaStatusTabs .status-tab');
            mangaTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    mangaTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    const status = this.getAttribute('data-status');
                    filterMangaByStatus(status);
                });
            });
        }
        
        // üîß –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ê–ù–ò–ú–ï
        function addAnime() {
            const title = document.getElementById('animeTitle').value.trim();
            const status = document.getElementById('animeStatus').value;
            const episodes = parseInt(document.getElementById('animeEpisodes').value) || 12;
            const progress = parseInt(document.getElementById('animeProgress').value) || 0;
            const rating = currentAnimeRating;
            
            if (!title) {
                showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–Ω–∏–º–µ', 'error');
                return;
            }
            
            const data = loadData();
            const newAnime = {
                id: Date.now().toString(),
                title,
                status,
                episodes,
                progress,
                rating,
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            };
            
            data.anime = data.anime || [];
            data.anime.push(newAnime);
            
            if (saveData(data)) {
                showNotification('–£—Å–ø–µ—Ö', '–ê–Ω–∏–º–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ!', 'success');
                resetForm('anime');
                loadAnimeContent();
            } else {
                showNotification('–û—à–∏–±–∫–∞', '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
            }
        }
        
        function loadAnimeContent() {
            const data = loadData();
            const animeList = document.getElementById('animeList');
            const activeTab = document.querySelector('#animeStatusTabs .status-tab.active');
            const status = activeTab ? activeTab.getAttribute('data-status') : 'all';
            
            let animeToShow = data.anime || [];
            if (status !== 'all') {
                animeToShow = animeToShow.filter(anime => anime.status === status);
            }
            
            if (animeToShow.length === 0) {
                animeList.innerHTML = `
                    <div class="empty-reminders">
                        <div class="icon">üé¨</div>
                        <h4>–ù–µ—Ç –∞–Ω–∏–º–µ</h4>
                        <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ –∞–Ω–∏–º–µ –≤ —Å–≤–æ—é –∫–æ–ª–ª–µ–∫—Ü–∏—é</p>
                    </div>
                `;
                return;
            }
            
            animeList.innerHTML = animeToShow.map(anime => {
                const progressPercent = anime.episodes > 0 ? Math.round((anime.progress / anime.episodes) * 100) : 0;
                const statusText = getStatusText(anime.status);
                const ratingStars = '‚òÖ'.repeat(anime.rating) + '‚òÜ'.repeat(5 - anime.rating);
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${anime.title}</div>
                            <div class="item-status">${statusText}</div>
                        </div>
                        <div class="item-meta">
                            <span>–≠–ø–∏–∑–æ–¥—ã: ${anime.progress}/${anime.episodes}</span>
                            <span>–†–µ–π—Ç–∏–Ω–≥: ${ratingStars}</span>
                        </div>
                        <div class="item-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <div class="progress-text">
                                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                                <span>${progressPercent}%</span>
                            </div>
                        </div>
                        <div class="item-actions">
                            <button class="action-btn" onclick="updateAnimeProgress('${anime.id}', ${anime.progress + 1})">+1 —ç–ø.</button>
                            <button class="action-btn" onclick="editAnime('${anime.id}')">‚úèÔ∏è</button>
                            <button class="action-btn" onclick="deleteAnime('${anime.id}')">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function filterAnimeByStatus(status) {
            loadAnimeContent();
        }
        
        function updateAnimeProgress(id, newProgress) {
            const data = loadData();
            const anime = data.anime.find(a => a.id === id);
            
            if (anime) {
                anime.progress = Math.min(newProgress, anime.episodes);
                anime.lastUpdated = new Date().toISOString();
                
                if (anime.progress >= anime.episodes && anime.status !== 'completed') {
                    anime.status = 'completed';
                    showNotification('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!', `–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ "${anime.title}"!`, 'success');
                }
                
                saveData(data);
                loadAnimeContent();
                updateGoals();
            }
        }
        
        function editAnime(id) {
            // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            showNotification('–ò–Ω—Ñ–æ', '–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        }
        
        function deleteAnime(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∞–Ω–∏–º–µ?')) {
                const data = loadData();
                data.anime = data.anime.filter(a => a.id !== id);
                saveData(data);
                loadAnimeContent();
                showNotification('–£—Å–ø–µ—Ö', '–ê–Ω–∏–º–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
            }
        }
        
        // üîß –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ú–ê–ù–ì–ò (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∞–Ω–∏–º–µ)
        function addManga() {
            const title = document.getElementById('mangaTitle').value.trim();
            const status = document.getElementById('mangaStatus').value;
            const chapters = parseInt(document.getElementById('mangaChapters').value) || 50;
            const progress = parseInt(document.getElementById('mangaProgress').value) || 0;
            const rating = currentMangaRating;
            
            if (!title) {
                showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞–Ω–≥–∏', 'error');
                return;
            }
            
            const data = loadData();
            const newManga = {
                id: Date.now().toString(),
                title,
                status,
                chapters,
                progress,
                rating,
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            };
            
            data.manga = data.manga || [];
            data.manga.push(newManga);
            
            if (saveData(data)) {
                showNotification('–£—Å–ø–µ—Ö', '–ú–∞–Ω–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                resetForm('manga');
                loadMangaContent();
            } else {
                showNotification('–û—à–∏–±–∫–∞', '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
            }
        }
        
        function loadMangaContent() {
            const data = loadData();
            const mangaList = document.getElementById('mangaList');
            const activeTab = document.querySelector('#mangaStatusTabs .status-tab.active');
            const status = activeTab ? activeTab.getAttribute('data-status') : 'all';
            
            let mangaToShow = data.manga || [];
            if (status !== 'all') {
                mangaToShow = mangaToShow.filter(manga => manga.status === status);
            }
            
            if (mangaToShow.length === 0) {
                mangaList.innerHTML = `
                    <div class="empty-reminders">
                        <div class="icon">üìö</div>
                        <h4>–ù–µ—Ç –º–∞–Ω–≥–∏</h4>
                        <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –º–∞–Ω–≥—É –≤ —Å–≤–æ—é –∫–æ–ª–ª–µ–∫—Ü–∏—é</p>
                    </div>
                `;
                return;
            }
            
            mangaList.innerHTML = mangaToShow.map(manga => {
                const progressPercent = manga.chapters > 0 ? Math.round((manga.progress / manga.chapters) * 100) : 0;
                const statusText = getStatusText(manga.status);
                const ratingStars = '‚òÖ'.repeat(manga.rating) + '‚òÜ'.repeat(5 - manga.rating);
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${manga.title}</div>
                            <div class="item-status">${statusText}</div>
                        </div>
                        <div class="item-meta">
                            <span>–ì–ª–∞–≤—ã: ${manga.progress}/${manga.chapters}</span>
                            <span>–†–µ–π—Ç–∏–Ω–≥: ${ratingStars}</span>
                        </div>
                        <div class="item-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <div class="progress-text">
                                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                                <span>${progressPercent}%</span>
                            </div>
                        </div>
                        <div class="item-actions">
                            <button class="action-btn" onclick="updateMangaProgress('${manga.id}', ${manga.progress + 1})">+1 –≥–ª.</button>
                            <button class="action-btn" onclick="editManga('${manga.id}')">‚úèÔ∏è</button>
                            <button class="action-btn" onclick="deleteManga('${manga.id}')">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updateMangaProgress(id, newProgress) {
            const data = loadData();
            const manga = data.manga.find(m => m.id === id);
            
            if (manga) {
                manga.progress = Math.min(newProgress, manga.chapters);
                manga.lastUpdated = new Date().toISOString();
                
                if (manga.progress >= manga.chapters && manga.status !== 'completed') {
                    manga.status = 'completed';
                    showNotification('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!', `–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ "${manga.title}"!`, 'success');
                }
                
                saveData(data);
                loadMangaContent();
                updateGoals();
            }
        }
        
        // üîß –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
        let notifications = [];
        let notificationSettings = {
            enabled: true,
            progressReminders: true,
            goalNotifications: true,
            frequency: 3
        };
        
        function initializeNotifications() {
            loadNotificationSettings();
            checkForReminders();
            updateGoals();
            startNotificationChecker();
        }
        
        function showNotification(title, message, type = 'info', duration = 5000) {
            if (!notificationSettings.enabled) return;
            
            const notification = {
                id: Date.now(),
                title,
                message,
                type,
                timestamp: new Date()
            };
            
            notifications.push(notification);
            renderNotification(notification);
            
            if (duration > 0) {
                setTimeout(() => {
                    removeNotification(notification.id);
                }, duration);
            }
            
            return notification.id;
        }
        
        function renderNotification(notification) {
            const panel = document.getElementById('notificationsPanel');
            const icons = {
                info: 'üí°',
                success: '‚úÖ',
                warning: '‚ö†Ô∏è',
                error: '‚ùå',
                reminder: 'üîî',
                goal: 'üéØ'
            };
            
            const notificationElement = document.createElement('div');
            notificationElement.className = 'notification';
            notificationElement.id = `notification-${notification.id}`;
            notificationElement.innerHTML = `
                <div class="notification-icon">${icons[notification.type] || icons.info}</div>
                <div class="notification-content">
                    <div class="notification-title">${notification.title}</div>
                    <div class="notification-message">${notification.message}</div>
                </div>
                <button class="notification-close" onclick="removeNotification(${notification.id})">√ó</button>
            `;
            
            panel.appendChild(notificationElement);
        }
        
        function removeNotification(id) {
            const notificationElement = document.getElementById(`notification-${id}`);
            if (notificationElement) {
                notificationElement.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    notificationElement.remove();
                }, 300);
            }
            
            notifications = notifications.filter(n => n.id !== id);
        }
        
        // üîß –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function showSection(sectionName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            document.getElementById(sectionName).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–∞–±
            document.querySelectorAll('.tab').forEach(tab => {
                if (tab.textContent.includes(getTabText(sectionName))) {
                    tab.classList.add('active');
                }
            });
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Å–µ–∫—Ü–∏–π
            if (sectionName === 'stats') {
                loadStats();
            } else if (sectionName === 'reminders') {
                updateRemindersUI();
                updateGoals();
            } else if (sectionName === 'anime') {
                loadAnimeContent();
            } else if (sectionName === 'manga') {
                loadMangaContent();
            }
        }
        
        function getTabText(sectionName) {
            const texts = {
                'anime': '–ê–Ω–∏–º–µ',
                'manga': '–ú–∞–Ω–≥–∞',
                'stats': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                'reminders': '–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è',
                'settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏'
            };
            return texts[sectionName] || '';
        }
        
        function getStatusText(status) {
            const statuses = {
                'watching': '–°–º–æ—Ç—Ä—é',
                'reading': '–ß–∏—Ç–∞—é',
                'planned': '–í –ø–ª–∞–Ω–∞—Ö',
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
                'dropped': '–ë—Ä–æ—à–µ–Ω–æ'
            };
            return statuses[status] || status;
        }
        
        function resetForm(type) {
            if (type === 'anime') {
                document.getElementById('animeTitle').value = '';
                document.getElementById('animeProgress').value = '0';
                currentAnimeRating = 0;
                document.querySelectorAll('#animeRating .star').forEach(star => {
                    star.classList.remove('active');
                });
            } else if (type === 'manga') {
                document.getElementById('mangaTitle').value = '';
                document.getElementById('mangaProgress').value = '0';
                currentMangaRating = 0;
                document.querySelectorAll('#mangaRating .star').forEach(star => {
                    star.classList.remove('active');
                });
            }
        }
        
        // üîß –°–¢–ê–¢–ò–°–¢–ò–ö–ê
        function loadStats() {
            const data = loadData();
            const generalStats = document.getElementById('generalStats');
            
            const animeCount = data.anime ? data.anime.length : 0;
            const mangaCount = data.manga ? data.manga.length : 0;
            const completedAnime = data.anime ? data.anime.filter(a => a.status === 'completed').length : 0;
            const completedManga = data.manga ? data.manga.filter(m => m.status === 'completed').length : 0;
            
            generalStats.innerHTML = `
                <div class="item-card">
                    <div class="item-meta">
                        <span>–í—Å–µ–≥–æ –∞–Ω–∏–º–µ: ${animeCount}</span>
                        <span>–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${completedAnime}</span>
                    </div>
                </div>
                <div class="item-card">
                    <div class="item-meta">
                        <span>–í—Å–µ–≥–æ –º–∞–Ω–≥–∏: ${mangaCount}</span>
                        <span>–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${completedManga}</span>
                    </div>
                </div>
            `;
            
            // –ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫
            const ctx = document.getElementById('statsChart').getContext('2d');
            if (window.statsChart) {
                window.statsChart.destroy();
            }
            
            window.statsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['–ê–Ω–∏–º–µ', '–ú–∞–Ω–≥–∞'],
                    datasets: [{
                        label: '–í—Å–µ–≥–æ',
                        data: [animeCount, mangaCount],
                        backgroundColor: 'rgba(102, 126, 234, 0.6)'
                    }, {
                        label: '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
                        data: [completedAnime, completedManga],
                        backgroundColor: 'rgba(118, 75, 162, 0.6)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: 'white'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }
        
        // üîß –¶–ï–õ–ò –ò –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–Ø
        function updateGoals() {
            const data = loadData();
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay());
            startOfWeek.setHours(0, 0, 0, 0);
            
            let weeklyAnimeProgress = 0;
            let weeklyMangaProgress = 0;
            
            if (data.anime) {
                data.anime.forEach(anime => {
                    if (anime.lastUpdated && new Date(anime.lastUpdated) >= startOfWeek) {
                        weeklyAnimeProgress += 1;
                    }
                });
            }
            
            if (data.manga) {
                data.manga.forEach(manga => {
                    if (manga.lastUpdated && new Date(manga.lastUpdated) >= startOfWeek) {
                        weeklyMangaProgress += 1;
                    }
                });
            }
            
            const weeklyAnimeGoal = 5;
            const weeklyMangaGoal = 3;
            
            const animePercentage = Math.min((weeklyAnimeProgress / weeklyAnimeGoal) * 100, 100);
            const mangaPercentage = Math.min((weeklyMangaProgress / weeklyMangaGoal) * 100, 100);
            
            const goalsList = document.getElementById('goalsList');
            goalsList.innerHTML = `
                <div class="goal-card">
                    <div class="goal-header">
                        <div class="goal-title">üìÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</div>
                        <div class="goal-progress">${weeklyAnimeProgress}/${weeklyAnimeGoal} —ç–ø–∏–∑–æ–¥–æ–≤</div>
                    </div>
                    <div class="goal-bar">
                        <div class="goal-fill" style="width: ${animePercentage}%"></div>
                    </div>
                    <div class="goal-stats">
                        <span>–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ</span>
                        <span>${Math.round(animePercentage)}%</span>
                    </div>
                </div>
                
                <div class="goal-card">
                    <div class="goal-header">
                        <div class="goal-title">üìö –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ</div>
                        <div class="goal-progress">${weeklyMangaProgress}/${weeklyMangaGoal} –≥–ª–∞–≤</div>
                    </div>
                    <div class="goal-bar">
                        <div class="goal-fill" style="width: ${mangaPercentage}%"></div>
                    </div>
                    <div class="goal-stats">
                        <span>–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ</span>
                        <span>${Math.round(mangaPercentage)}%</span>
                    </div>
                </div>
            `;
        }
        
        function updateRemindersUI() {
            const container = document.getElementById('activeReminders');
            const data = loadData();
            const now = new Date();
            
            const activeItems = [];
            
            if (data.anime) {
                data.anime.forEach(anime => {
                    if (anime.status === 'watching') {
                        const lastUpdate = anime.lastUpdated ? new Date(anime.lastUpdated) : new Date(anime.createdAt);
                        const daysInactive = Math.floor((now - lastUpdate) / (1000 * 60 * 60 * 24));
                        
                        if (daysInactive >= 3) {
                            activeItems.push({
                                type: 'anime',
                                item: anime,
                                daysInactive: daysInactive
                            });
                        }
                    }
                });
            }
            
            if (data.manga) {
                data.manga.forEach(manga => {
                    if (manga.status === 'reading') {
                        const lastUpdate = manga.lastUpdated ? new Date(manga.lastUpdated) : new Date(manga.createdAt);
                        const daysInactive = Math.floor((now - lastUpdate) / (1000 * 60 * 60 * 24));
                        
                        if (daysInactive >= 3) {
                            activeItems.push({
                                type: 'manga',
                                item: manga,
                                daysInactive: daysInactive
                            });
                        }
                    }
                });
            }
            
            if (activeItems.length === 0) {
                container.innerHTML = `
                    <div class="empty-reminders">
                        <div class="icon">üéâ</div>
                        <h4>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</h4>
                        <p>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = activeItems.map(item => {
                const typeText = item.type === 'anime' ? '–∞–Ω–∏–º–µ' : '–º–∞–Ω–≥—É';
                const progressText = item.type === 'anime' ? 
                    `–≠–ø–∏–∑–æ–¥—ã: ${item.item.progress || 0}/${item.item.episodes}` :
                    `–ì–ª–∞–≤—ã: ${item.item.progress || 0}/${item.item.chapters}`;
                
                return `
                    <div class="reminder-item">
                        <div class="reminder-icon">${item.type === 'anime' ? 'üé¨' : 'üìö'}</div>
                        <div class="reminder-content">
                            <div class="reminder-title">${item.item.title}</div>
                            <div class="reminder-description">
                                –ù–µ –æ–±–Ω–æ–≤–ª—è–ª–∏ ${item.daysInactive} –¥–Ω–µ–π ‚Ä¢ ${progressText}
                            </div>
                        </div>
                        <div class="reminder-actions">
                            <button class="reminder-btn" onclick="update${item.type === 'anime' ? 'Anime' : 'Manga'}Progress('${item.item.id}', ${(item.item.progress || 0) + 1})">+1</button>
                            <button class="reminder-btn primary" onclick="showSection('${item.type}')">–ü–µ—Ä–µ–π—Ç–∏</button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // üîß –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–ú–ò
        function exportData() {
            const data = loadData();
            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `animanga-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('–£—Å–ø–µ—Ö', '–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (confirm('–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏?')) {
                            const userId = getUserId();
                            const key = `animanga_data_${userId}`;
                            localStorage.setItem(key, JSON.stringify(data));
                            showNotification('–£—Å–ø–µ—Ö', '–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
                            
                            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                            loadAnimeContent();
                            loadMangaContent();
                        }
                    } catch (error) {
                        showNotification('–û—à–∏–±–∫–∞', '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞', 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function clearData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.')) {
                const userId = getUserId();
                const key = `animanga_data_${userId}`;
                localStorage.removeItem(key);
                showNotification('–£—Å–ø–µ—Ö', '–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                loadAnimeContent();
                loadMangaContent();
                loadStats();
            }
        }
        
        // üîß –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        document.addEventListener('DOMContentLoaded', function() {
            initTelegramApp();
            initializeRatingSystem();
            initializeStatusTabs();
            initializeNotifications();
            
            loadAnimeContent();
            loadMangaContent();
            loadStats();
            updateGoals();
            updateRemindersUI();
            
            // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            setTimeout(() => {
                showNotification(
                    'üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!',
                    '–¢–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤–∞—à–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–µ',
                    'info',
                    6000
                );
            }, 1000);
        });
    </script>
</body>
    </html>
